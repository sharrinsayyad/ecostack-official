<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ECOSTACK AI - CEO Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background-color: #0f172a; color: #f8fafc; font-family: sans-serif; }
        .box-style { background: #1e293b; border: 1px solid #334155; border-radius: 12px; padding: 20px; }
        .accent-green { color: #22c55e; }
    </style>
</head>
<body class="p-6">

    <header class="text-center mb-8">
        <h1 class="text-3xl font-bold accent-green">ECOSTACK AI</h1>
        <p class="text-slate-400">Real-Time Code Analysis & Optimization</p>
    </header>

    <div class="max-w-7xl mx-auto space-y-6">
        
        <div class="grid md:grid-cols-2 gap-6">
            <div class="box-style">
                <h2 class="font-bold mb-2 text-red-400">AUDIT CODE (INPUT)</h2>
                <textarea id="userInput" class="w-full h-64 bg-slate-900 p-4 font-mono text-sm border border-slate-700 rounded focus:outline-none" placeholder="Paste messy code here..."></textarea>
            </div>
            <div class="box-style relative">
                <div id="lockOverlay" class="absolute inset-0 bg-slate-900/90 flex flex-col items-center justify-center rounded-xl z-10 text-center">
                    <span class="text-3xl mb-2">ðŸ”’</span>
                    <p class="font-bold">Optimized Code Locked</p>
                    <p class="text-xs text-slate-500">Waiting for Admin Approval</p>
                </div>
                <h2 class="font-bold mb-2 text-green-400">OPTIMIZED CODE (OUTPUT)</h2>
                <div id="optimizedCode" class="w-full h-64 bg-slate-900 p-4 font-mono text-sm overflow-auto text-slate-500 italic">
                    // Optimized version will appear here after approval...
                </div>
            </div>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            <div class="box-style border-b-4 border-red-500">
                <p class="text-xs text-slate-400 font-bold uppercase">Light Bill Waste</p>
                <p id="bill" class="text-xl font-bold mt-1">â‚¹0.00</p>
            </div>
            <div class="box-style border-b-4 border-blue-500">
                <p class="text-xs text-slate-400 font-bold uppercase">Total Savings</p>
                <p id="savings" class="text-xl font-bold mt-1">â‚¹0.00</p>
            </div>
            <div class="box-style border-b-4 border-green-500">
                <p class="text-xs text-slate-400 font-bold uppercase text-green-400">Our 35% Share</p>
                <p id="share" class="text-xl font-bold mt-1 text-green-400">â‚¹0.00</p>
            </div>
            <div class="box-style border-b-4 border-yellow-500">
                <p class="text-xs text-slate-400 font-bold uppercase">Power Usage</p>
                <p id="power" class="text-xl font-bold mt-1">-- kWh</p>
            </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6">
            <div class="box-style text-center">
                <h3 class="font-bold mb-4">PAYMENT OPTIONS</h3>
                <div id="qrBox" class="bg-white p-2 inline-block rounded mb-4">
                    </div>
                <p class="text-[10px] text-slate-400 mb-4">UPI: sayyadsharrin0@okaxis</p>
                <button onclick="sendWhatsApp()" class="w-full bg-blue-600 hover:bg-blue-700 py-3 rounded font-bold transition">
                    I've Paid - Send Approval Request
                </button>
            </div>

            <div class="box-style text-center">
                <h3 class="font-bold mb-4 text-yellow-500">ADMIN CONTROL</h3>
                <input type="password" id="adminKey" class="w-full bg-slate-900 border border-slate-700 p-3 rounded text-center mb-4" placeholder="Enter Admin Secret Code">
                <button id="approveBtn" onclick="verifyAdmin()" class="w-full bg-yellow-600 hover:bg-yellow-500 text-black font-bold py-3 rounded mb-4">
                    APPROVE REQUEST
                </button>
                <button id="dlBtn" class="hidden w-full bg-white text-black py-2 rounded font-bold">
                    ðŸ“¥ DOWNLOAD REPORT (PDF)
                </button>
            </div>
        </div>

        <div id="historyPanel" class="hidden box-style overflow-x-auto">
            <h3 class="font-bold mb-4 accent-green">OPTIMIZATION HISTORY (ADMIN ONLY)</h3>
            <table class="w-full text-left text-sm">
                <thead>
                    <tr class="text-slate-500 border-b border-slate-700">
                        <th class="p-2">Date</th>
                        <th class="p-2">User</th>
                        <th class="p-2">Savings</th>
                        <th class="p-2">Commission (35%)</th>
                    </tr>
                </thead>
                <tbody id="historyData">
                    </tbody>
            </table>
        </div>
    </div>

    <script>
        const THE_KEY = "rubinaramjan@14"; // Aapka password

        // Real-time Calculation
        document.getElementById('userInput').addEventListener('input', function(e) {
            const val = e.target.value;
            if(val.length > 0) {
                const waste = (val.length * 0.5).toFixed(2);
                const save = (waste * 0.65).toFixed(2);
                const comm = (save * 0.35).toFixed(2);
                const kwh = (val.length * 0.007).toFixed(3);

                document.getElementById('bill').innerText = 'â‚¹' + waste;
                document.getElementById('savings').innerText = 'â‚¹' + save;
                document.getElementById('share').innerText = 'â‚¹' + comm;
                document.getElementById('power').innerText = kwh + ' kWh';
                
                const upi = `upi://pay?pa=sayyadsharrin0@okaxis&pn=Sharrin%20Sayyad&am=${comm}&cu=INR`;
                document.getElementById('qrBox').innerHTML = `<img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(upi)}" alt="QR">`;
            }
        });

        // WhatsApp Logic
        function sendWhatsApp() {
            const comm = document.getElementById('share').innerText;
            const userCode = document.getElementById('userInput').value;
            const msg = `ECOSTACK AI PAYMENT DONE\nAmount: ${comm}\n\nUser Code:\n${userCode.substring(0, 100)}...\n\nPlease approve my request!`;
            window.open(`https://wa.me/9096530829?text=${encodeURIComponent(msg)}`);
        }

        // Admin Approval Logic
        function verifyAdmin() {
            const input = document.getElementById('adminKey').value;
            if(input === THE_KEY) {
                alert("Request Approved! Code Unlocked.");
                document.getElementById('lockOverlay').style.display = 'none';
                document.getElementById('optimizedCode').innerText = "// OPTIMIZED CODE BY ECOSTACK AI\n// Power usage reduced by 60%\n\nfunction efficiency() {\n  return 'Optimized successfully';\n}";
                document.getElementById('optimizedCode').classList.remove('text-slate-500');
                document.getElementById('optimizedCode').classList.add('text-green-400');
                document.getElementById('dlBtn').classList.remove('hidden');
                document.getElementById('historyPanel').classList.remove('hidden');
                
                // Add to history
                const row = `<tr><td class="p-2 text-xs">${new Date().toLocaleDateString()}</td><td class="p-2 text-xs">USER-ECO</td><td class="p-2 text-xs text-blue-400">${document.getElementById('savings').innerText}</td><td class="p-2 text-xs text-green-400">${document.getElementById('share').innerText}</td></tr>`;
                document.getElementById('historyData').innerHTML += row;
            } else {
                alert("Wrong Admin Code!");
            }
        }
    </script>
</body>
</html>
